# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

**KokonutUI** is an open-source UI component library website (kokonutui.com). It showcases 100+ UI components built with Next.js, React, and Tailwind CSS. The site is a documentation/showcase platform — users install components into their own projects via the shadcn CLI (`npx shadcn@latest add @kokonutui/<name>`).

## Commands

```bash
bun run dev          # Dev server with Turbopack
bun run build        # Production build
bun run lint         # Next.js linter

bun x ultracite fix  # Format and auto-fix linting issues (run before committing)
bun x ultracite check  # Check for issues without fixing

bun run ./scripts/build-registry.ts  # Rebuild public/r/*.json registry files + public/llms.txt
```

## Architecture

### App Router Route Groups

- `app/(root)/` — Marketing/landing pages with `Header` + `Footer` layout.
- `app/docs/` — Fumadocs documentation with notebook layout. Catch-all `[[...slug]]` renders MDX files from `content/docs/`.
- `app/api/search/` — Orama full-text search API used by Fumadocs.

### Key Directories

- `components/kokonutui/` — The 44 actual UI components that ship in the registry.
- `components/ui/` — shadcn/ui base primitives (accordion, button, dialog, etc.)
- `components/landing/` — Marketing page sections (hero, feature cards, etc.)
- `components/mdx/` — Custom MDX renderers: `Preview`, `PreviewClient`, `PreviewTemplate`, code display, package-manager tabs.
- `components/icons/` — SVG icon components for AI vendors and frameworks.
- `content/docs/` — MDX documentation files, one per component.
- `registry/` — Registry entry definitions (components, hooks, lib); combined in `registry/index.ts`.
- `hooks/` — 8 shared React hooks (auto-resize-textarea, click-outside, copy-to-clipboard, debounce, file-input, intersection, mobile, tags).
- `lib/` — `utils.ts` (cn helper), `action.ts` (server actions), `shared.ts` (Shiki highlighting), `source.ts` (Fumadocs loader).
- `public/r/` — Pre-built registry JSON files (auto-generated by CI, don't edit manually).
- `scripts/build-registry.ts` — Reads component source files, outputs `public/r/*.json` and `public/llms.txt`.

### Component Source Serving

`lib/action.ts` contains Server Actions that read `.tsx` source files from `components/kokonutui/` at runtime (using React `cache()`). This powers the copy-to-clipboard feature shown in documentation previews — the MDX `Preview` components use these actions to display and serve component source code.

### Registry System

Each component has an entry in `registry/registry-components.ts` (name, dependencies, files). The build script reads the actual source files and outputs `public/r/{name}.json` with embedded file contents. GitHub Actions automatically rebuilds and commits these JSON files when components or registry files change on `main`.

### Routing / Redirects

- `/components` → redirects to `/docs/components/liquid-glass-card`
- `/components/:path*` → redirects to `/docs/components/:path*`
- `/r/:path` (no extension) → redirects to `/r/:path.json`
- `/r/*.json` is served as long-cached static files from `public/r/`

## Tech Stack

- **Next.js 16** (App Router) + **React 19**
- **TypeScript** (strict mode), path alias `@/*` → `./*`
- **Tailwind CSS v4**
- **Motion** (Framer Motion v12) for animations
- **Fumadocs** (fumadocs-ui, fumadocs-core, fumadocs-mdx) for documentation
- **Biome** via Ultracite for linting/formatting (config: `biome.jsonc` extends `ultracite/core`, `ultracite/react`, `ultracite/next`)
- **Shiki v3** for syntax highlighting (server-side, github-light/dark themes)
- **Bun** as package manager

## Important Patterns

- Always use `@/` path alias, never relative imports across directories.
- Run `bun x ultracite fix` before committing — Biome enforces strict rules (no `any`, no `console`, `import type` for types, etc.). Full rule set is in `.claude/CLAUDE.md`.
- When adding a new component to the registry, add its entry to `registry/registry-components.ts` and run the build-registry script to update `public/r/`.
- Docs are MDX files in `content/docs/components/`. Each page typically uses the `Preview` MDX component to render a live demo and source viewer.
- The site uses Vercel Analytics and Speed Insights — no custom tracking to maintain.
